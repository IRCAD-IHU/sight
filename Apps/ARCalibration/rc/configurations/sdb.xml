
<extension implements="::fwServices::registry::AppConfig">
    <id>SDBARCalibration</id>
    <parameters>
        <param name="GENERIC_UID" />
        <param name="SERIESDB" />
        <param name="WID_PARENT" />
        <param name="DYNAMICVIEW_CHANNEL" default="channel" />
        <param name="ICON_PATH" />
    </parameters>
    <config>

        <object type="::fwData::Composite">

            <service uid="${GENERIC_UID}_mainview" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="yes">
                <gui>
                    <layout type="::fwGui::CardinalLayoutManager">
                        <view caption="Information" align="center" minWidth="200" />
                    </layout>
                    <toolBar />
                </gui>
                <registry>
                    <parent wid="${WID_PARENT}" />
                    <toolBar sid="toolBar" start="yes" />
                    <view sid="${GENERIC_UID}_selector" start="yes" />
                </registry>
            </service>

            <service uid="toolBar" type="::fwGui::IToolBarSrv" impl="::gui::aspect::SDefaultToolBar" autoConnect="no">
                <gui>
                    <layout>
                        <menuItem name="Launch activity" icon="Bundles/media_0-1/icons/Launch_activity.svg" />
                        <separator />
                        <menuItem name="Calibration activity" icon="Bundles/arMedia_0-1/icons/calibrationActivity.svg" />
                        <menuItem name="Export CameraSeries calibration" icon="Bundles/media_0-1/icons/Export.svg" />
                    </layout>
                </gui>
                <registry>
                    <menuItem sid="${GENERIC_UID}_action_newActivity" start="yes" />
                    <menuItem sid="${GENERIC_UID}_action_calibrationActivity" start="yes" />
                    <menuItem sid="${GENERIC_UID}_action_exportCameraActivity" start="yes" />
                </registry>
            </service>

            <item key="seriesDB">
                <object uid="${SERIESDB}" type="::fwMedData::SeriesDB" src="ref">
                    <service uid="${GENERIC_UID}_selector" impl="::uiMedData::editor::SSelector" autoConnect="yes">
                        <selectionId>${GENERIC_UID}_selections</selectionId>
                        <icons>
                            <icon series="::arData::CameraSeries" icon="Bundles/arMedia_0-1/icons/calibrationActivity.svg" />
                        </icons>
                    </service>
                </object>
            </item>

            <item key="selections">
                <object uid="${GENERIC_UID}_selections" type="::fwData::Vector">

                    <service uid="${GENERIC_UID}_action_newActivity" type="::fwGui::IActionSrv" impl="::activities::action::SActivityLauncher" autoConnect="yes">
                        <config>
                            <parameters>
                                <parameter replace="SERIESDB" by="${SERIESDB}" />
                                <parameter replace="ICON_PATH" by="${ICON_PATH}" />
                            </parameters>
                        </config>
                    </service>

                    <service uid="${GENERIC_UID}_action_calibrationActivity" type="::fwGui::IActionSrv" impl="::activities::action::SActivityLauncher" autoConnect="yes">
                        <config>
                            <parameters>
                                <parameter replace="SERIESDB" by="seriesDB" />
                                <parameter replace="ICON_PATH" by="${ICON_PATH}" />
                            </parameters>
                            <filter>
                                <mode>include</mode>
                                <id>Calibration</id>
                            </filter>
                        </config>
                    </service>
                    <service uid="${GENERIC_UID}_action_exportCameraActivity" type="::fwGui::IActionSrv" impl="::activities::action::SActivityLauncher" autoConnect="yes">
                        <config>
                            <mode>immediate</mode>
                            <parameters>
                                <parameter replace="SERIESDB" by="seriesDB" />
                                <parameter replace="ICON_PATH" by="${ICON_PATH}" />
                            </parameters>
                            <filter>
                                <mode>include</mode>
                                <id>CameraSeriesExport</id>
                            </filter>
                        </config>
                    </service>
                </object>
            </item>

            <connect>
                <signal>${GENERIC_UID}_selector/seriesDoubleClicked</signal>
                <slot>${GENERIC_UID}_action_newActivity/launchSeries</slot>
            </connect>

            <proxy channel="${DYNAMICVIEW_CHANNEL}">
                <signal>${GENERIC_UID}_action_newActivity/activityLaunched</signal>
                <signal>${GENERIC_UID}_action_calibrationActivity/activityLaunched</signal>
            </proxy>

            <start uid="${GENERIC_UID}_mainview" />
        </object>

    </config>
</extension>
