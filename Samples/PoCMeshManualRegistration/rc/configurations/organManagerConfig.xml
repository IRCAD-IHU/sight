<extension implements="::fwServices::registry::AppConfig">
    <id>organManagerConfig</id>
    <parameters>
        <param name="MODEL_SERIES_UID" />
        <param name="CLOSE_CONFIG_CHANNEL" default="DummyChannel" /><!-- defined by SConfigLauncher -->
        <param name="ModelRepresentationChannel" />
        <param name="ModelDisplayChannel" />
    </parameters>
    <config>


        <object type="::fwData::Composite">

            <!-- MAIN FRAME -->
            <service uid="organManagerFrame" type="::fwGui::IFrameSrv" impl="::gui::frame::SDefaultFrame" autoConnect="no">
                <window onclose="notify" />
                <gui>
                    <frame>
                        <name>Organs Manager</name>
                        <icon>@BUNDLE_PREFIX@/PoCMeshManualRegistration_0-1/tuto.ico</icon>
                        <minSize width="400" height="600" />
                        <style mode="STAY_ON_TOP" />
                    </frame>
                </gui>
                <registry>
                    <view sid="multiViewOrgans" start="yes" />
                </registry>
            </service>

            <service uid="multiViewOrgans" type="::gui::view::IView" impl="::gui::view::SDefaultView" autoConnect="no">
                <gui>
                    <layout type="::fwGui::LineLayoutManager">
                        <orientation value="vertical" />
                        <view proportion="1" />
                        <view minHeight="80" proportion="0" />
                        <view minHeight="220" proportion="0" />
                    </layout>
                </gui>
                <registry>
                    <view sid="listOrganEditor" start="yes" />
                    <view sid="organMaterialEditor" />
                    <view sid="representationEditor" />
                </registry>
            </service>

            <service uid="updaterReconst" impl="::ctrlSelection::updater::SObjFromSlot" type="::ctrlSelection::IUpdaterSrv" autoConnect="no">
                <compositeKey>reconstruction</compositeKey>
            </service>

            <service uid="managerForOrgansFrame" impl="::ctrlSelection::manager::SwapperSrv" type="::ctrlSelection::IManagerSrv" autoConnect="yes">
                <mode type="dummy" />
                <config>
                    <object id="reconstruction" type="::fwData::Reconstruction">
                        <service uid="organMaterialEditor" impl="::uiReconstruction::OrganMaterialEditor" type="::gui::editor::IEditor" autoConnect="no" />
                        <service uid="representationEditor" impl="::uiReconstruction::RepresentationEditor" type="::gui::editor::IEditor" autoConnect="no" />

                        <proxy channel="${ModelRepresentationChannel}">
                            <signal>representationEditor/normalsModeModified</signal>
                        </proxy>
                    </object>
                </config>
            </service>

            <item key="modelSeries">
                <object uid="${MODEL_SERIES_UID}" src="ref" type="::fwMedData::ModelSeries">
                    <service uid="listOrganEditor" impl="::uiMedData::editor::SModelSeriesList" type="::gui::editor::IEditor" autoConnect="yes">
                        <columns>
                            <organ_name>@organ_name</organ_name>
                        </columns>
                    </service>
                </object>
            </item>

            <connect>
                <signal>listOrganEditor/reconstructionSelected</signal>
                <slot>updaterReconst/addOrSwap</slot>
            </connect>

            <proxy channel="${CLOSE_CONFIG_CHANNEL}">
                <signal>organManagerFrame/closed</signal>
            </proxy>

            <proxy channel="${ModelDisplayChannel}">
                <signal>listOrganEditor/recDisplayModified</signal>
                <slot>listOrganEditor/showReconstructions</slot>
            </proxy>

            <!-- START AND STOP SERVICES -->
            <start uid="organManagerFrame" />
            <start uid="updaterReconst" />
            <start uid="managerForOrgansFrame" />

        </object>


    </config>
</extension>
